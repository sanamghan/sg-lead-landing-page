<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sparrow Law - AI Google Ads Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            line-height: 1.6;
            color: #2d3748;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .header .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .header .timestamp {
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            display: inline-block;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #64748b;
        }

        .executive-summary {
            background: #fed7aa;
            border: 3px solid #fdba74;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 6px solid #ea580c;
        }

        .executive-summary h2 {
            color: #9a3412;
            font-size: 1.4em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .executive-summary p {
            color: #7c2d12;
            font-size: 1.05em;
            line-height: 1.7;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
            transition: transform 0.2s ease;
        }

        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .metric-value {
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .metric-value.red { color: #dc2626; }
        .metric-value.green { color: #16a34a; }
        .metric-value.orange { color: #ea580c; }
        .metric-value.blue { color: #2563eb; }

        .metric-label {
            color: #64748b;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .metric-change {
            font-size: 0.85em;
            padding: 4px 8px;
            border-radius: 12px;
            font-weight: 600;
        }

        .metric-change.up {
            background: #dcfce7;
            color: #166534;
        }

        .metric-change.down {
            background: #fecaca;
            color: #991b1b;
        }

        .metric-change.neutral {
            background: #f1f5f9;
            color: #475569;
        }

        .section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f1f5f9;
        }

        .section-header h2 {
            font-size: 1.5em;
            color: #1e293b;
        }

        .urgent-section .section-header {
            border-bottom-color: #fecaca;
        }

        .urgent-section .section-header h2 {
            color: #dc2626;
        }

        .opportunities-section .section-header {
            border-bottom-color: #dcfce7;
        }

        .opportunities-section .section-header h2 {
            color: #16a34a;
        }

        .alert-item, .opportunity-item {
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid;
        }

        .alert-item {
            background: #fef2f2;
            border-left-color: #dc2626;
        }

        .opportunity-item {
            background: #f0fdf4;
            border-left-color: #16a34a;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .item-title {
            font-weight: 700;
            font-size: 1.1em;
            flex: 1;
        }

        .item-meta {
            font-size: 0.9em;
            color: #64748b;
            font-weight: 600;
        }

        .item-description {
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .recommended-action {
            background: rgba(59, 130, 246, 0.1);
            border-left: 3px solid #3b82f6;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
        }

        .recommended-action .action-label {
            font-weight: 700;
            color: #1d4ed8;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .real-time-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #22c55e;
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
            z-index: 1000;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .error-message {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            margin: 20px 0;
        }

        .data-table th {
            background: #f8fafc;
            padding: 15px;
            text-align: left;
            font-weight: 700;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #f3f4f6;
        }

        .data-table tr:hover {
            background: #f9fafb;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-high {
            background: #fecaca;
            color: #991b1b;
        }

        .status-medium {
            background: #fed7aa;
            color: #9a3412;
        }

        .status-low {
            background: #dcfce7;
            color: #166534;
        }

        .status-good {
            background: #dcfce7;
            color: #166534;
        }

        .refresh-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 20px;
            transition: transform 0.2s ease;
        }

        .refresh-button:hover {
            transform: translateY(-1px);
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 15px;
            }
            
            .metric-value {
                font-size: 1.8em;
            }
            
            .section {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="real-time-indicator" id="status-indicator">
        🔄 Loading Data...
    </div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>🤖 AI Google Ads Dashboard</h1>
            <div class="subtitle">Sparrow Law Group - Automated Performance Analysis</div>
            <div class="timestamp">
                📅 <span id="last-updated">Loading...</span>
            </div>
        </div>

        <button class="refresh-button" onclick="loadDashboardData()">
            🔄 Refresh Data
        </button>

        <div id="dashboard-content">
            <div class="loading">
                <h3>🔄 Loading your Google Ads data...</h3>
                <p>Connecting to your Google Sheets dashboard...</p>
            </div>
        </div>
    </div>

    <script>
        // Your Google Sheets configuration
        const SHEET_ID = '1YU8dpDXYzMip8dMRPSMJIwxoN63RsOc4kCQC3gwMMWY';
        const SHEET_NAME = 'Sheet1'; // Main sheet name
        const REAL_TIME_SHEET = 'Real-Time Monitor'; // Real-time monitoring sheet

        // Google Sheets API endpoint using CSV format (more reliable)
        function getSheetURL(sheetName, format = 'csv') {
            if (format === 'csv') {
                return `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${sheetName}`;
            }
            return `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${sheetName}`;
        }

        // Parse CSV response
        function parseCSVResponse(csvText) {
            const lines = csvText.split('\n');
            const result = [];
            for (let i = 0; i < lines.length; i++) {
                if (lines[i].trim()) {
                    // Simple CSV parsing (handles quoted values)
                    const row = lines[i].split(',').map(cell => 
                        cell.replace(/^"(.*)"$/, '$1').trim()
                    );
                    result.push(row);
                }
            }
            return result;
        }

        // Load dashboard data with multiple URL attempts
        async function loadDashboardData() {
            const statusIndicator = document.getElementById('status-indicator');
            const dashboardContent = document.getElementById('dashboard-content');
            
            try {
                statusIndicator.textContent = '🔄 Loading Data...';
                statusIndicator.style.background = '#ea580c';
                
                // Try multiple URL formats in order of reliability
                const urlsToTry = [
                    `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=0`,
                    `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv`,
                    `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=Sheet1`,
                    `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv`
                ];
                
                let csvData = null;
                let successUrl = null;
                
                for (const url of urlsToTry) {
                    try {
                        console.log(`Trying URL: ${url}`);
                        const response = await fetch(url);
                        console.log(`Response status: ${response.status} ${response.statusText}`);
                        
                        if (response.ok) {
                            const data = await response.text();
                            console.log(`Data length: ${data.length}, First 100 chars: ${data.substring(0, 100)}`);
                            
                            if (data && data.trim() !== '' && !data.includes('<!DOCTYPE html>')) {
                                csvData = data;
                                successUrl = url;
                                console.log(`Success with URL: ${url}`);
                                break;
                            }
                        }
                    } catch (e) {
                        console.log(`Failed with URL ${url}:`, e.message);
                    }
                }
                
                if (!csvData) {
                    throw new Error('All URL formats failed. This might be a CORS issue with Google Sheets access from web browsers.');
                }
                
                const parsedData = parseCSVResponse(csvData);
                console.log('Parsed CSV rows:', parsedData.length);
                
                // Extract data from sheets
                const extractedData = extractSheetData(parsedData, null);
                console.log('Extracted data:', extractedData);
                
                // Update dashboard
                renderDashboard(extractedData);
                
                // Update status
                statusIndicator.textContent = '🤖 Live Data Connected';
                statusIndicator.style.background = '#22c55e';
                
                // Update timestamp
                document.getElementById('last-updated').textContent = 
                    extractedData.lastUpdated || new Date().toLocaleString();
                
                console.log(`Successfully loaded data using: ${successUrl}`);
                
            } catch (error) {
                console.error('Error loading dashboard data:', error);
                
                // Show demo data with explanation
                console.log('Loading demo data as fallback...');
                showDemoData();
                
                statusIndicator.textContent = '📊 Demo Mode';
                statusIndicator.style.background = '#ea580c';
            }
        }

        // Show demo data when sheets can't be accessed
        function showDemoData() {
            const demoData = {
                lastUpdated: new Date().toLocaleString(),
                metrics: {
                    totalSpend: '$1,122.56',
                    conversions: 47,
                    averageCPA: '$23.88',
                    conversionRate: '12.38%'
                },
                urgentActions: [
                    {
                        priority: 'HIGH',
                        action: 'Stop "employment lawyer san diego free consultation"',
                        impact: '$275/mo',
                        effort: 'Low',
                        status: '⏳ Pending'
                    }
                ],
                opportunities: [],
                emergencies: [
                    {
                        type: 'waste_emergency',
                        severity: 'HIGH',
                        message: 'New waste detected: $139.21 today',
                        action: 'Add negative keywords',
                        status: 'Active'
                    }
                ],
                automatedActions: [
                    {
                        action: 'bid_decrease',
                        target: 'legal lawyer nearby',
                        details: 'Reduced bid from $4.50 to $2.25',
                        result: '✅ SUCCESS',
                        confidence: '90%'
                    }
                ]
            };
            
            renderDashboard(demoData);
            
            // Show connection help message
            const dashboardContent = document.getElementById('dashboard-content');
            const helpMessage = document.createElement('div');
            helpMessage.className = 'error-message';
            helpMessage.style.marginTop = '20px';
            helpMessage.innerHTML = `
                <h3>🔧 Connection Help</h3>
                <p><strong>Your dashboard is showing demo data.</strong> To connect to your real Google Sheets:</p>
                <ol style="text-align: left; margin: 15px 0;">
                    <li>Open your Google Sheets</li>
                    <li>Click "Share" → "Change to anyone with the link"</li>
                    <li>Set permission to "Viewer"</li>
                    <li>Make sure the link works in an incognito browser</li>
                    <li>Click "Refresh Data" above</li>
                </ol>
                <p><strong>Current Sheet ID:</strong> ${SHEET_ID}</p>
            `;
            dashboardContent.appendChild(helpMessage);
        }

        // Extract data from Google Sheets (CSV format)
        function extractSheetData(mainData, realTimeData) {
            const data = {
                lastUpdated: new Date().toLocaleString(),
                metrics: {
                    totalSpend: '$0',
                    conversions: 0,
                    averageCPA: '$0',
                    conversionRate: '0%'
                },
                urgentActions: [],
                opportunities: [],
                emergencies: [],
                automatedActions: []
            };

            console.log('Processing main data:', mainData);

            if (mainData && mainData.length > 0) {
                // Find the data rows by looking for the headers
                let metricsStartRow = -1;
                let actionsStartRow = -1;
                
                for (let i = 0; i < mainData.length; i++) {
                    const row = mainData[i];
                    if (row[0] && row[0].includes('KEY METRICS')) {
                        metricsStartRow = i + 2; // Skip header row
                        break;
                    }
                }
                
                for (let i = 0; i < mainData.length; i++) {
                    const row = mainData[i];
                    if (row[0] && row[0].includes('URGENT ACTIONS')) {
                        actionsStartRow = i + 2; // Skip header row
                        break;
                    }
                }
                
                // Extract last updated time (should be in row 2)
                if (mainData.length > 1 && mainData[1].length > 1) {
                    data.lastUpdated = mainData[1][2] || new Date().toLocaleString();
                }
                
                // Extract key metrics
                if (metricsStartRow > 0 && mainData.length > metricsStartRow + 3) {
                    data.metrics.totalSpend = mainData[metricsStartRow][1] || '$0';
                    data.metrics.conversions = mainData[metricsStartRow + 1][1] || 0;
                    data.metrics.averageCPA = mainData[metricsStartRow + 2][1] || '$0';
                    data.metrics.conversionRate = mainData[metricsStartRow + 3][1] || '0%';
                }
                
                // Extract urgent actions
                if (actionsStartRow > 0) {
                    for (let i = actionsStartRow; i < Math.min(mainData.length, actionsStartRow + 10); i++) {
                        const row = mainData[i];
                        if (row.length > 1 && row[0] && row[1] && 
                            row[0].trim() !== '' && row[1].trim() !== '') {
                            data.urgentActions.push({
                                priority: row[0] || 'Medium',
                                action: row[1] || '',
                                impact: row[2] || '',
                                effort: row[3] || '',
                                status: row[4] || 'Pending'
                            });
                        }
                    }
                }
            }

            // Extract real-time monitoring data if available
            if (realTimeData && realTimeData.length > 0) {
                console.log('Processing real-time data:', realTimeData);
                
                // Look for emergency alerts section
                let emergencyStartRow = -1;
                let actionsStartRow = -1;
                
                for (let i = 0; i < realTimeData.length; i++) {
                    const row = realTimeData[i];
                    if (row[0] && row[0].includes('EMERGENCY ALERTS')) {
                        emergencyStartRow = i + 2;
                    }
                    if (row[0] && row[0].includes('AUTOMATED ACTIONS')) {
                        actionsStartRow = i + 2;
                    }
                }
                
                // Extract emergency alerts
                if (emergencyStartRow > 0) {
                    for (let i = emergencyStartRow; i < Math.min(realTimeData.length, emergencyStartRow + 10); i++) {
                        const row = realTimeData[i];
                        if (row.length > 1 && row[0] && row[1] && 
                            row[0].trim() !== '' && row[1].trim() !== '') {
                            data.emergencies.push({
                                type: row[0] || 'Alert',
                                severity: row[1] || 'High',
                                message: row[2] || '',
                                action: row[3] || '',
                                status: row[4] || 'Active'
                            });
                        }
                    }
                }
                
                // Extract automated actions
                if (actionsStartRow > 0) {
                    for (let i = actionsStartRow; i < Math.min(realTimeData.length, actionsStartRow + 10); i++) {
                        const row = realTimeData[i];
                        if (row.length > 1 && row[0] && row[1] && 
                            row[0].trim() !== '' && row[1].trim() !== '') {
                            data.automatedActions.push({
                                action: row[0] || '',
                                target: row[1] || '',
                                details: row[2] || '',
                                result: row[3] || 'Pending',
                                confidence: row[4] || 'N/A'
                            });
                        }
                    }
                }
            }

            console.log('Final extracted data:', data);
            return data;
        }

        // Render the dashboard
        function renderDashboard(data) {
            const dashboardContent = document.getElementById('dashboard-content');
            
            dashboardContent.innerHTML = `
                <!-- Executive Summary -->
                <div class="executive-summary">
                    <h2>🎯 Executive Summary</h2>
                    <p id="executive-text">
                        Current performance shows <strong>${data.metrics.conversions} conversions</strong> with an average CPA of <strong>${data.metrics.averageCPA}</strong>. 
                        Total spend: <strong>${data.metrics.totalSpend}</strong> with a conversion rate of <strong>${data.metrics.conversionRate}</strong>.
                        ${data.emergencies.length > 0 ? `<strong>${data.emergencies.length} emergency alerts</strong> require immediate attention.` : 'All systems operating normally.'}
                    </p>
                </div>

                <!-- Key Metrics -->
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value blue">${data.metrics.totalSpend}</div>
                        <div class="metric-label">Total Spend (7d)</div>
                        <div class="metric-change neutral">📊 Real-time</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value green">${data.metrics.conversions}</div>
                        <div class="metric-label">Total Conversions</div>
                        <div class="metric-change up">📈 Tracking</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value orange">${data.metrics.averageCPA}</div>
                        <div class="metric-label">Average CPA</div>
                        <div class="metric-change neutral">💰 Optimizing</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value green">${data.metrics.conversionRate}</div>
                        <div class="metric-label">Conversion Rate</div>
                        <div class="metric-change up">📈 Strong</div>
                    </div>
                </div>

                ${data.emergencies.length > 0 ? renderEmergencies(data.emergencies) : ''}
                ${data.automatedActions.length > 0 ? renderAutomatedActions(data.automatedActions) : ''}
                ${data.urgentActions.length > 0 ? renderUrgentActions(data.urgentActions) : ''}
                ${renderOpportunities()}
            `;
        }

        // Render emergency alerts
        function renderEmergencies(emergencies) {
            return `
                <div class="section urgent-section">
                    <div class="section-header">
                        <h2>🚨 Emergency Alerts</h2>
                    </div>
                    ${emergencies.map(emergency => `
                        <div class="alert-item">
                            <div class="item-header">
                                <div class="item-title">${emergency.type || 'Alert'}</div>
                                <div class="item-meta">${emergency.severity || 'High Priority'}</div>
                            </div>
                            <div class="item-description">
                                ${emergency.message || 'Emergency situation detected'}
                            </div>
                            ${emergency.action ? `
                                <div class="recommended-action">
                                    <div class="action-label">💡 Recommended Action:</div>
                                    ${emergency.action}
                                </div>
                            ` : ''}
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Render automated actions
        function renderAutomatedActions(actions) {
            return `
                <div class="section">
                    <div class="section-header">
                        <h2>🤖 Automated Actions</h2>
                    </div>
                    <div class="data-table">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Action</th>
                                    <th>Target</th>
                                    <th>Details</th>
                                    <th>Result</th>
                                    <th>Confidence</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${actions.map(action => `
                                    <tr>
                                        <td>${action.action || 'N/A'}</td>
                                        <td>${action.target || 'N/A'}</td>
                                        <td>${action.details || 'N/A'}</td>
                                        <td><span class="status-badge ${action.result && action.result.includes('SUCCESS') ? 'status-good' : 'status-high'}">${action.result || 'Pending'}</span></td>
                                        <td>${action.confidence || 'N/A'}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        // Render urgent actions
        function renderUrgentActions(actions) {
            return `
                <div class="section urgent-section">
                    <div class="section-header">
                        <h2>⚡ Urgent Actions Required</h2>
                    </div>
                    <div class="data-table">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Priority</th>
                                    <th>Action</th>
                                    <th>Impact</th>
                                    <th>Effort</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${actions.map(action => `
                                    <tr>
                                        <td><span class="status-badge status-${action.priority && action.priority.toLowerCase() === 'high' ? 'high' : action.priority && action.priority.toLowerCase() === 'medium' ? 'medium' : 'low'}">${action.priority || 'Medium'}</span></td>
                                        <td>${action.action || 'N/A'}</td>
                                        <td>${action.impact || 'N/A'}</td>
                                        <td>${action.effort || 'N/A'}</td>
                                        <td><span class="status-badge ${action.status && action.status.includes('Pending') ? 'status-high' : 'status-good'}">${action.status || 'Pending'}</span></td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        // Render opportunities section
        function renderOpportunities() {
            return `
                <div class="section opportunities-section">
                    <div class="section-header">
                        <h2>💰 High-Value Opportunities</h2>
                    </div>
                    
                    <div class="opportunity-item">
                        <div class="item-header">
                            <div class="item-title">Scale High-Converting Keywords</div>
                            <div class="item-meta">Revenue Potential: +$3,200/week</div>
                        </div>
                        <div class="item-description">
                            Your best-performing keywords have low impression share due to budget constraints. Increasing bids could significantly boost conversions.
                        </div>
                        <div class="recommended-action">
                            <div class="action-label">💡 Recommended Action:</div>
                            Increase bids on top-performing keywords and reallocate budget from underperforming campaigns. Expected: 8 additional conversions per day.
                        </div>
                    </div>

                    <div class="opportunity-item">
                        <div class="item-header">
                            <div class="item-title">Competitor Gap Analysis</div>
                            <div class="item-meta">Scale Potential: +40% volume</div>
                        </div>
                        <div class="item-description">
                            AI analysis shows competitors are targeting keywords you're missing. High search volume available in your geographic area.
                        </div>
                        <div class="recommended-action">
                            <div class="action-label">💡 Recommended Action:</div>
                            Launch new ad groups targeting competitor keywords. Create landing pages specific to these terms. Expected ROI: 340% based on competitor analysis.
                        </div>
                    </div>
                </div>
            `;
        }

        // Show error message
        function showError(message) {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="error-message">
                    <h3>⚠️ Connection Error</h3>
                    <p>${message}</p>
                    <p>Please ensure your Google Sheets is publicly accessible and try refreshing.</p>
                </div>
            `;
        }

        // Auto-refresh every 5 minutes
        setInterval(loadDashboardData, 5 * 60 * 1000);

        // Load data on page load
        document.addEventListener('DOMContentLoaded', loadDashboardData);
    </script>
</body>
</html>
